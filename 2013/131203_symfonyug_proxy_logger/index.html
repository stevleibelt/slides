<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Proxy Logger Component</title><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link></head><body class="impress-not-supported"><div id="impress" data-transition-duration="1500"><div class="step" step="0" data-x="0" data-y="0"><h1 id="proxy-logger-component">Proxy Logger Component</h1><div class="line-block">03.12.2013<br></br>Symfony User Group Hamburg<br></br>mindworks GmbH<br></br></div></div><div class="step" step="1" data-x="1600" data-y="0"><h1 id="what-is-this-talk-about">What Is This Talk About?</h1><ul><li>distinction between logging, metrics and writing of history</li><li>present you a way of logging</li><li>present you a logging component</li></ul></div><div class="step" step="2" data-x="3200" data-y="0"><h1 id="why-at-a-symfony-usergroup">Why At A Symfony UserGroup?</h1><pre class="highlight code php"><span class="x">"symfony/event-dispatcher": "v2.3.5"    //since version 1.2.0 :-)</span></pre></div><div class="step" step="3" data-x="4800" data-y="0"><h1 id="logging-metrics-or-writing-of-history">Logging, Metrics Or Writing Of History?</h1><p>I gain the feeling that things where mixing up.</p></div><div class="step" step="4" data-x="6400" data-y="0"><h1 id="what-does-it-all-mean">What Does It All Mean?</h1><ul><li>analyse internal data</li><li>archive internal data</li><li>collect internal data</li><li>meter internal data</li><li>record internal data</li></ul></div><div class="step" step="5" data-x="8000" data-y="0"><h1 id="logging">Logging?</h1><blockquote><p>In computing, a logfile or simply log is a file that records events taking place in the execution of a system in order to provide an audit trail that can be used to understand the activity of the system and to diagnose problems. The act of keeping a logfile is called logging. ([0])</p></blockquote></div><div class="step" step="6" data-x="9600" data-y="0"><h1 id="metrics">Metrics?</h1><blockquote><p>A software metric is a measure of some property of a piece of software or its specifications [...]
The goal is obtaining objective, reproducible and quantifiable measurements, which may have numerous valuable applications in schedule and budget planning, cost estimation, quality assurance testing, software debugging, software performance optimization, and optimal personnel task assignments. ([1])</p></blockquote><h1 id="writing-of-history">Writing Of History?</h1><ul><li><dl><dt>recoding of events like:</dt><dd><ul><li>user (id 3) had registerd with link "<a href="http://www.foo.bar/my-add-uuid-123">http://www.foo.bar/my-add-uuid-123</a>"</li><li>user (id 3) purchased contract (id 9)</li><li>archive user interactions for the reason of law</li></ul></dd></dl></li><li><dl><dt>preserve status of a bunch of data</dt><dd><ul><li>create graph of data transformation</li><li>record when happen what on which set of data</li></ul></dd></dl></li></ul></div><div class="step" step="7" data-x="11200" data-y="0"><h1 id="and-graylog2-as-an-example-is">And Graylog2 (As An Example) Is?</h1><blockquote><p>Graylog2 is for data analysis ([2])</p></blockquote><p>So graylog is pure web analytics (doing all at once if you ask me).</p></div><div class="step" step="8" data-x="12800" data-y="0"><h1 id="what-do-i-mean-with-logging">What Do I Mean With Logging?</h1><ul><li>record of workflow</li><li>record of processed data</li><li>dump of processed data if something went wrong</li><li>the more it went wrong, the more i want to get dumped</li><li>logging per instance (webserver)</li><li>dumping process data? secure your logfiles!</li><li>not meaning webserver log but web application log</li><li>delete old log files or log entries without fear</li><li>change log behaviour without fear</li><li>split your logs into logical units (import/export/registration)</li></ul></div><div class="step" step="9" data-x="14400" data-y="0"><h1 id="confused">Confused?</h1><ul><li>figure out what your customer want</li><li><dl><dt>your customer should know what to measure</dt><dd><ul><li>avoid measure everything</li><li>do not interpret data by adding wished cross connections</li></ul></dd></dl></li><li>try to define common terms for your team and your customer</li><li>separate you data</li><li>create logger, history and metric writer (even if they are all simple file writer)</li></ul></div><div class="step" step="10" data-x="16000" data-y="0"><h1 id="all-i-want-to-do-is-to-do-logging">All I Want To Do Is To Do Logging</h1><h2 id="what-i-struggled-with">What I Struggled With</h2><ul><li>never found the right balance between logging enough to debug and do not glut the logfiles</li><li>set loglevel to warning and you are loosing notice, info or debug</li><li>set loglevel to info and your log file will be flooded with messages</li></ul><h2 id="what-i-need">What I Need</h2><ul><li>if something goes wrong, "i want it all" ([3])</li></ul></div><div class="step" step="11" data-x="17600" data-y="0"><h1 id="how-to-solve-this-problem">How To Solve This Problem?</h1><p>Log all process data but only when something goes wrong.</p></div><div class="step" step="12" data-x="19200" data-y="0"><h1 id="meaning">Meaning?</h1><ul><li>buffer log entries</li><li>clean or flush the buffer under well defined circumstances</li><li>deal with (a collection of) psr3 loggers</li><li>one log target (file/database column/whatever) per logical log unit (like import/purchase/migration)</li></ul></div><div class="step" step="13" data-x="20800" data-y="0"><h1 id="history-of-development">History Of Development</h1><ul><li>so i searched and found nothing good for php</li><li>started developing and released version 0.9.0</li><li>it was working but, it looks like a first draft ;-)</li><li>later on i stumbled over monolog and its FingersCrossedHandler (so i'm not alone with that concept of logging :-))</li><li>monolog looks like a big, monolithic logging component (sorry if i'm wrong)</li><li>big refactoring and implementation of event driven design leads to version 1.2.0</li><li>story continues :-)</li></ul></div><div class="step" step="14" data-x="22400" data-y="0"><h1 id="what-it-is">What It Is</h1><ul><li>defines a log request as a php object</li><li>wraps your existing logger or loggers</li><li>create a logger collection by using the proxy logger</li><li>collect a bunch of log entries by using the buffer logger</li><li>controll the buffer behaviour by using the buffer manipulators</li><li>influence the process flow by using the build in event system</li><li>be lazy, use the factories</li><li>use the IsValidLogLevel</li><li>follows unix philosophy (do one thing and do it well)</li><li>you can enrich you existing logger component</li></ul></div><div class="step" step="15" data-x="24000" data-y="0"><h1 id="showtime">Showtime</h1><p>Time for some demo implementation!</p></div><div class="step" step="16" data-x="25600" data-y="0"><h1 id="what-it-is-not">What It Is Not</h1><ul><li>it simple deals with log entries</li><li>it does not care how to store</li><li>it does not care where to store</li><li>is not <em>the</em> logger component, just a part of it</li></ul></div><div class="step" step="17" data-x="27200" data-y="0"><h1 id="common-terms">Common Terms</h1><ul><li>RealLogger represents a psr-3 logger</li><li>LogRequest represents a log request (log level, message and context)</li><li>LogRequestBuffer represents a collection of log requests that are not pushed to the real loggers</li><li>ProxyLogger represents a collection of real loggers</li><li>BufferLogger represents as a log request keeper that pass each log request to a buffer</li><li>BypassBufferInterface represents a buffer manipulation to bypass a certain log level to all added real loggers</li><li>FlushBufferTriggerInterface represents a buffer manipulation to trigger a buffer flush based on a log level</li></ul></div><div class="step" step="18" data-x="28800" data-y="0"><h1 id="installation">Installation</h1><p>Use composer and packagist.</p><pre class="highlight code php"><span class="x">require: "net_bazzline/component_proxy_logger": "dev-master"</span></pre></div><div class="step" step="19" data-x="30400" data-y="0"><h1 id="how-to-use-it">How To Use It?</h1><h2 id="instead-of">instead of</h2><pre class="highlight code php"><span class="x">class MyLoggerFactory
{
    public function createMyProcessLogger()
    {
        return new Logger();
    }
}</span></pre></div><div class="step" step="20" data-x="32000" data-y="0"><h1 id="use-this">use this</h1><pre class="highlight code php"><span class="x">class MyLoggerFactory
{
    public function createMyProcessLogger()
    {
        $realLogger = new Logger();

        //of course this should not be done on each create call
        $proxyLoggerFactory = new ProxyLoggerFactory();
        $proxyLogger = $proxyLoggerFactory-&gt;create($realLogger);

        return $proxyLogger;
    }
}</span></pre></div><div class="step" step="21" data-x="33600" data-y="0"><h1 id="what-else">What Else?</h1><p>If you have to deal with log4php loggers, use an adapter.</p><p>And the adapter works vica versa (super cool, put in a psr3 logger in an log4php environment).</p></div><div class="step" step="22" data-x="35200" data-y="0"><h1 id="crux">Crux?</h1><ul><li>do not log all</li><li>structure your log</li><li>explain your customer that they want metric or history</li><li>add bugs or remarks to the component</li><li>joind the development team</li></ul></div><div class="step" step="23" data-x="36800" data-y="0"><h1 id="questions">Questions?</h1><ul><li><dl><dt>who is using monolog?</dt><dd><ul><li>what are your experience?</li><li>positives</li><li>negatives?</li></ul></dd></dl></li><li>what loggers are you using?</li><li>do you use your log files to create metrics?</li></ul></div><div class="step" step="24" data-x="38400" data-y="0"><h1 id="your-opinion">Your Opinion?</h1><ul><li>how do you like the main idea of the component?</li></ul></div><div class="step" step="25" data-x="40000" data-y="0"><h1 id="thanks">Thanks!</h1></div></div><div id="hovercraft-help"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Left, Down, Page Down</th><td>Next slide</td></tr><tr><th>Right, Up, Page Up</th><td>Previous slide</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>